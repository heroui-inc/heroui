/* Base accordion styles */
.accordion {
  @apply w-full;

  /* Performance optimization - contain layout changes */
  contain: layout style;
}

/* Accordion elements */
.accordion__body {
  @apply text-sm;
}

.accordion__body-inner {
  @apply text-muted px-4 pb-4 pt-0;
}

.accordion__heading {
  @apply flex;
}

.accordion__indicator {
  @apply text-muted ml-auto size-4 shrink-0;

  /**
   * Transitions
   */
  @apply duration-250 transition motion-reduce:transition-none;

  /* Expanded state for indicator rotation */
  &[data-expanded="true"] {
    @apply -rotate-180;
  }
}

/* Accordion Item - Separator styles */
.accordion__item {
  @apply relative border-none;
}

.accordion__item::after {
  content: "";
  @apply bg-divider absolute bottom-0 left-0 h-px w-full rounded-full;
}

.accordion__item:last-child::after {
  content: none;
}
/* ------------------------------------ */

.accordion__trigger {
  cursor: var(--cursor-interactive);

  /* Base Styles */
  @apply flex flex-1 items-center justify-between px-4 py-4 text-left text-sm font-medium;

  /**
   * Transitions
   * CRITICAL: motion-reduce must be AFTER transition for correct override specificity
   */
  transition:
    opacity 150ms var(--ease-smooth),
    box-shadow 150ms var(--ease-out);
  @apply motion-reduce:transition-none;

  /* Hover state */
  &:hover:not([aria-expanded="true"]),
  &[data-hovered="true"]:not([aria-expanded="true"]),
  /* Pressed state */
  &[data-pressed="true"]:not([aria-expanded="true"]) {
    background-color: color-mix(in oklab, var(--color-foreground) 6%, transparent 90%);
  }

  /* Focus state */
  &:focus-visible,
  &[data-focus-visible="true"] {
    @apply status-focused;
  }

  /* Disabled State */
  &:disabled,
  &[aria-disabled="true"] {
    @apply status-disabled;
  }
}

.accordion__panel {
  opacity: 0;
  will-change: height, opacity;
  height: var(--disclosure-panel-height);
  overflow: clip;

  /**
   * Transitions
   * CRITICAL: motion-reduce must be AFTER transition for correct override specificity
   */
  transition:
    height 420ms var(--ease-fluid-out),
    opacity 340ms var(--ease-out);
  @apply motion-reduce:transition-none;

  &[data-expanded="true"] {
    opacity: 1;
  }
}

/* Surface variant */
.accordion--surface {
  @apply bg-surface rounded-3xl;

  .accordion__trigger {
    &:hover:not([aria-expanded="true"]),
    &[data-hovered="true"]:not([aria-expanded="true"]) {
      @apply bg-default;
    }
  }
}

.accordion--surface .accordion__item {
  /* Surface variant separator styling */
  &::after {
    @apply left-[3%] w-[94%];
  }

  /* Special rounding for first and last items in surface variant */
  &:first-child [data-slot="accordion-trigger"] {
    @apply rounded-t-3xl;
  }

  &:last-child:not(:has([data-slot="accordion-trigger"][aria-expanded="true"]))
    [data-slot="accordion-trigger"] {
    @apply rounded-b-3xl;
  }
}
