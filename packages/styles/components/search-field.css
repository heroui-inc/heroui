/* Search field styles */
.search-field {
  @apply flex flex-col gap-1;

  &[data-invalid="true"],
  &[aria-invalid="true"] {
    [data-slot="description"] {
      @apply hidden;
    }
  }

  [data-slot="label"] {
    @apply w-fit;
  }

  [data-slot="description"] {
    @apply px-1;
  }
}

.search-field__group {
  @apply inline-flex h-9 items-center overflow-hidden rounded-field border bg-field text-sm text-field-foreground shadow-field outline-none;
  border-width: var(--border-width-field);
  border-color: var(--color-field-border);

  /**
   * Transitions
   * CRITICAL: motion-reduce must be AFTER transition for correct override specificity
   */
  transition:
    background-color 150ms var(--ease-smooth),
    border-color 150ms var(--ease-smooth),
    box-shadow 150ms var(--ease-out);
  @apply motion-reduce:transition-none;

  /* Hover state */
  @media (hover: hover) {
    &:hover:not(:focus-within),
    &[data-hovered="true"]:not([data-focus-within="true"]) {
      @apply bg-field-hover;
      border-color: var(--color-field-border-hover);
    }
  }

  /* Focus within state */
  &[data-focus-within="true"],
  &:focus-within {
    @apply status-focused-field;
  }

  /* Invalid state */
  &[data-invalid="true"] {
    @apply status-invalid-field;
    background-color: var(--color-field-focus);
    border-color: var(--color-field-border-invalid);
  }

  /* Disabled state */
  &[data-disabled="true"],
  &[aria-disabled="true"] {
    @apply status-disabled;
  }
}

.search-field__input {
  @apply flex-1 rounded-none border-0 bg-transparent px-3 py-2 text-base shadow-none outline-none sm:text-sm;

  /* Hide browser default search clear button */
  &::-webkit-search-cancel-button,
  &::-webkit-search-decoration {
    -webkit-appearance: none;
    appearance: none;
  }

  /* Remove border radius on left side when search icon is present */
  .search-field__group:has([data-slot="search-field-search-icon"]) & {
    @apply rounded-l-none pl-2;
  }

  /* Remove border radius on right side when clear button is present */
  .search-field__group:has([slot="clear"]) & {
    @apply rounded-r-none pr-2;
  }

  /* Focus state - handled by group */
  &:focus,
  &:focus-visible {
    @apply outline-none;
  }
}

.search-field__search-icon {
  @apply pointer-events-none shrink-0 text-field-placeholder;
  @apply mr-0 ml-3 size-4;
}

.search-field__clear-button {
  @apply mr-1 shrink-0;

  /* Overrides close button default icon size from 16px to 12px */
  [data-slot="close-button-icon"] {
    @apply size-3;
  }
}

/**
 * In-Surface Variants
 * Used when search field group is placed on a Surface component background.
 * Uses CSS custom properties to reduce repetition.
 */
.search-field__group--in-surface-default,
.search-field__group--in-surface-secondary,
.search-field__group--in-surface-tertiary {
  @apply shadow-none;
  background-color: var(--search-field-group-bg);

  @media (hover: hover) {
    &:hover:not(:focus-within),
    &[data-hovered="true"]:not([data-focus-within="true"]) {
      background-color: var(--search-field-group-bg-hover);
    }
  }

  &:focus-within,
  &[data-focus-within="true"] {
    background-color: var(--search-field-group-bg-focus);
  }

  /* Invalid state */
  &[data-invalid="true"] {
    @apply status-invalid-field;
    border-color: var(--color-field-border-invalid);
    background-color: var(--search-field-group-bg-focus);
  }

  [data-slot="search-field-input"] {
    @apply bg-transparent;
  }
}

/* In-surface variant property definitions */
.search-field__group--in-surface-transparent {
}

.search-field__input--in-surface-transparent {
}

.search-field__group--in-surface-default {
  --search-field-group-bg: var(--color-in-surface);
  --search-field-group-bg-hover: var(--color-in-surface-hover);
  --search-field-group-bg-focus: var(--color-in-surface-focus);
}

.search-field__group--in-surface-secondary {
  --search-field-group-bg: var(--color-in-surface-secondary);
  --search-field-group-bg-hover: var(--color-in-surface-secondary-hover);
  --search-field-group-bg-focus: var(--color-in-surface-secondary-focus);
}

.search-field__group--in-surface-tertiary {
  --search-field-group-bg: var(--color-in-surface-tertiary);
  --search-field-group-bg-hover: var(--color-in-surface-tertiary-hover);
  --search-field-group-bg-focus: var(--color-in-surface-tertiary-focus);
}

/* Full width modifier */
.search-field--full-width {
  @apply w-full;
}

.search-field__group--full-width {
  @apply w-full;
}
